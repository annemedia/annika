ann.cl.reg.regset={pub:"",address:"",salut:"",email:"",country:"",pic:"",tier:"",social:"",web:""},ann.cl.reg.makeReg=async function(e,t){let n=document.querySelector(".reg-wrap");n&&n.remove(),ann.cl.onload.regOnLoad=async function(){document.querySelector("reg").setAttribute("data-before","Welcome Patron")};var a=await ann.getCountries();let l="custominput hide";return localStorage.getItem("tier")>0&&(l="custominput"),ann.Subroutine("reg+ann.cl.onload.regOnLoad",["div_y","reg_y","div_y","croppie_120_120","$3_form_y_@submit","input_text_@blur","$5_div_x","$7_input_text","$7_input_button","$5_input_text","$5_input_email","$5_select","$5_button","$0_div_y",async function(){ann.cl.onload.postRegOnLoad=async function(){ann.waitForGlobal("bitcoin",(function(){let e=document.getElementsByClassName("datakey")[0],t=localStorage.getItem("wif");if(!t){t=ann.newNeuron().WIF}e.innerHTML=t,localStorage.removeItem("wif"),ann.copyToClipboard()}))};return ann.Subroutine("postreg+ann.cl.onload.postRegOnLoad",["$2_postreg_y","h3","$1_div_y","$1_div_y","$1_div_y","$1_div_x","button","$6_button"],[null,"Your Key Your Data","As a Royalty Patron, you are the bearer of the Patron Key. The key is unique to the holder. Its use satisfies the proof of the Patrons identity and enables the holder to retrieve and edit registration data and claim any rewards associated with the corresponding Tier.<br><br>Copy and paste the key into a safe place or write it down for safekeeping. <b>Unless desired, never share it with anyone, and do not lose it.</b> We do not have a copy and cannot recover it.","PlacEHo1dERkey77WfUwy99UbZAL3vhmaFxMYzdnBJ544XhgBLaS","Nevertheless, you may encrypt your Patron Key and keep the key safely in our custody. No one, including anyone with access to our servers, will be able to see or use your key, but you can retrieve and decrypt it using a secret password of your choosing.",null,"MY CUSTODY ONLY","OUR SAFEKEEPING"],["hide fadeOut","mt-10","datakeyinfo inlineb","datakey copycontent","datakeyinfo",null,"iambutton w-50","iambutton w-50"],[null,null,null,null,null,null,n,n]);async function n(n,a){var l=a.path[1].querySelectorAll("button"),o=!1;for(var r in l[1].id===n&&(o=!0),l)"object"==typeof l[r]&&(l[r].disabled=!0);if(!a.path[2].querySelector(".copycontent").classList.contains("off")){for(var r in ann.modal("ACTION REQUIRED","Make a copy of your Patron Key, keep it safe.",1,a.path[3]),l)"object"==typeof l[r]&&(l[r].disabled=!1);return}await ann.cl.reg.register(ann.cl.reg.regset,a.path[2].parentElement,o);let i=document.querySelector("reg"),u=document.getElementsByClassName("links")[0];ann.isVisible(u)&&ann.toggleFade(u);let s=i.querySelector("postreg");var c=i.getElementsByClassName("croppie-inner")[0];ann.show(s,!1),ann.show(c.parentElement.parentElement,!1);var d=document.getElementById("heart").parentElement;s.before(d),ann.isVisible(d)||ann.toggleFade(d);let p=document.getElementById("regsuccess");p||(p=document.createElement("p"),p.id="regsuccess",p.style.fontSize="1.5rem",p.style.padding="20px",p.innerHTML="REGISTRATION SUCCESS",d.append(p),setTimeout((function(){ann.toggleFade(d),setTimeout((function(){if(ann.show(d,!1),e)e(n,a);else{let e=document.getElementsByClassName("reg-wrap")[0];ann.toggleFade(e),setTimeout((function(){e.remove()}),2500)}}),500)}),2500)),t&&t(n,a)}}],[null,null,null,null,null,"label_Salutation",null,"xlabel_Social Media Link (optional)","add","label_Website Link (optional)","label_Email (optional)",[a,"Country Of Influence",0,"3+2"],"REGISTER",null,null],["reg-wrap hide",null,"o-v",null,"o-v","custominput w-218px",null,"custominput","custominput",l+" w-218px","custominput w-218px","customselect scrollbar","annikabutton regbtn","w-50 links hide fadeOut",null],[null,null,null,null,null,async function(e,t){ann.validateSalutation(t)},null,null,function(e,t){let n=t.path[0].previousSibling,a=document.getElementsByClassName("links")[0],l=a.querySelectorAll("div");if(3===l.length)return void ann.modal("LIMIT REACHED","A maximum three social media links are allowed.",1,t.path[3]);if(n&&n.value.trim().includes("https")&&ann.isVisible(n)&&n.value.length>10){let e="<div class='inlineb'><span class='pointer sclose'>x&nbsp;</span><span>"+n.value.replace(/\/$/,"")+"</span></div>",r=new URL(n.value);for(var o in n.value="",l)if("object"==typeof l[o]&&l[o].firstChild.nextElementSibling.innerHTML.includes(r.hostname))return void ann.modal("DUPLICATE LINK","You have already added a link for this social network.",1,t.path[3]);a.insertAdjacentHTML("beforeend",e);let i=document.getElementsByClassName("sclose");ann.createListener(i[i.length-1],"click",(function(e,t){if(t.path[0].parentElement.remove(),!document.getElementsByClassName("sclose")[0]){let e=document.getElementsByClassName("links")[0];ann.toggleFade(e)}})),ann.isVisible(a)||ann.toggleFade(a)}else ann.modal("INVALID LINK","Include a valid link starting with https://",1,t.path[3])},null,null,null,async function(e,t){if(t.preventDefault(),0===function(e){let t=e.path[2].querySelector(".croppie-container");return t.croppie.img?(ann.cl.reg.regset.pic=t.croppie.img,1):(ann.modal("MISSING PICTURE","Please upload your profile picture and confirm its position.",1,e.path[2]),0)}(t))return;if(0===await ann.validateSalutation(t))return;if(0===function(e){let t=e.path[1].querySelectorAll('input:not([type="hidden"]')[1];if(ann.isVisible(t)){let i=document.querySelectorAll(".links div");var n,a,l=new Set,o=0;if(t.value&&t.value.trim().includes("https")){for(var r in a=new URL(t.value),i)"object"==typeof i[r]&&i[r].firstChild.nextElementSibling.innerHTML.includes(a.hostname)&&(l.add(i[r].firstChild.nextElementSibling.innerHTML),o++);!o&&i.length<5&&l.add(t.value.replace(/\/$/,""))}for(var r in i)"object"==typeof i[r]&&l.add(i[r].firstChild.nextElementSibling.innerHTML.replace(/\/$/,""));return l&&(n=Array.from(l)),n&&n.length?(ann.cl.reg.regset.social=n,1):(ann.modal("MISSING SOCIAL LINK","Do you wish to skip adding links to your social media profiles?",2,e.path[2]),0)}}(t)&&(await ann.modalResponse(),0===ann.get.modal.response))return;if(0===function(e){let t=e.path[1].querySelectorAll('input:not([type="hidden"]')[3];return ann.isVisible(t)&&(!t.value||!t.value.trim().includes("https")||t.value.length<11)?(ann.modal("MISSING WEB LINK","Do you wish to skip adding a website link?",2,e.path[2]),0):(ann.cl.reg.regset.web=t.value.replace(/\/$/,""),1)}(t)&&(await ann.modalResponse(),0===ann.get.modal.response))return;if(0===await ann.validateEmail(t)&&(await ann.modalResponse(),0===ann.get.modal.response))return;if(0===ann.validateCountry(t))return;let n=t.path[2].querySelector(".discardimage"),a=t.path[2].querySelector(".customlabel");ann.show(n,!1),ann.show(a,!1);let l=t.path[2].querySelector("form");ann.show(l,!1),t.path[2].parentElement.setAttribute("data-before","Welcome "+ann.cl.reg.regset.salut);let o=document.querySelector("postreg");ann.toggleFade(o)},null,null])},ann.validateCountry=function(e,t){var n,a;t?(a=t,n=t):(a=e.path[2],n=e.path[1]);let l=n.querySelector(".selected").getAttribute("value");if(!l||0==l)return ann.modal("MISSING DATA","Please choose a country of your influence.",1,a),0;ann.cl.reg.regset.country=l},ann.validateEmail=async function(e,t,n,a,l){var o,r;return o=t||e.path[1].querySelectorAll('input:not([type="hidden"]')[4],r=n||e.path[2],o&&o.value&&o.value.includes("@")&&o.value.includes(".")&&!(!o.value.length>6)?(ann.cl.reg.regset.email=o.value,1):(l?ann.modal("INVALID EMAIL",l,a,r):ann.modal("INVALID EMAIL","It's your right to remain anonymous, but your email serves as a convenient way to provide updates and support. If you skip adding your email, we cannot notify you of our progress, and it's up to you to check for any updates we publish against your profile. Do you want to proceed without adding your email?",2,r),0)},ann.validateSalutation=async function(e,t,n,a){var l,o;e.preventDefault(),l=t||e.path[1].querySelector('input:not([type="hidden"]'),o=n||e.path[2];var r,i=l.value;return i&&i.trim().length>0&&i.trim().length<2?(ann.modal("MISSING DATA","Your salutation is missing or is too short. Please enter your salutation.",1,o),0):(i&&(i=i.trim()),i&&""!==i&&(r=await ann.fetch("getSalut",{salut:i,pub:a},"POST")),1!==r&&""!==i?(ann.modal("UNAVAILABLE","Sorry, "+i+" is taken. Please choose another salutation.",1,o),l.value="",e.stopImmediatePropagation(),0):(ann.cl.reg.regset.salut=l.value,1))},ann.cl.reg.register=async function(e,t,n=!1){if(!e)return;if((t=t)||(t=document.getElementsByTagName("reg")[0]),!t)return;n=n?2:1,ann.modal("SESSION PASSWORD","<span class='inlineb'>Enter &nbsp;<hoverwrap><u>session password</u>.<hovertip>This password will be used to encrypt & protect the key in your browser's cache. We cannot recover this password. If you lose it, you can clear the cache and use your Patron Key to set a new password.</hovertip></hoverwrap></span>",1,t,n);var a=document.getElementsByClassName("datakey")[0].innerHTML,l=ann.getPublicAddressFromWif(a);if(localStorage.setItem("pub",l),ann.cl.reg.regset.pub=l,ann.cl.reg.regset.address=localStorage.getItem("out-done")?localStorage.getItem("out-done"):localStorage.getItem("mout-done"),await ann.modalResponse(),0!=ann.get.modal.response){var o=localStorage.getItem("pass");localStorage.removeItem("pass");var r=localStorage.getItem("safekeeping");if(localStorage.removeItem("safekeeping"),o){let e=await ann.fetch("createID",ann.cl.reg.regset,"POST");if(e.salut&&e.salut[0]&&e.salut[0].includes("has already been taken"))return void ann.modal("UNAVAILABLE","Sorry, "+ann.cl.reg.regset.salut+" is taken. Please use different salutation.",1);if(e.out&&e.out[0]&&e.out[0].includes("field is required."))return;localStorage.removeItem("out-done");var i,u=await ann.encryptRoutine(a,o,e[0]);r&&(i=(await ann.encryptRoutine(a,r)).item),localStorage.setItem("api-token",e[1]),localStorage.setItem("enwif",u.item);let t=u.ik,n=u.count,l=sha256(e[0]),s={pub:ann.cl.reg.regset.pub,ik:t,count:n,msg:l,safe:i};await ann.fetch("updateID",s,"POST")}}},ann.cl.auth.authModule=async function(){return ann.requireObject(ann.cl.auth.callback,1e4).then((function(l){return ann.keep.isChecked=!1,ann.cl.onload.patronAuth=async function(){let e=localStorage.getItem("enwif");if(e&&e.length>52){let t=document.querySelector("auth"),n=t.querySelector("input");n.setAttribute("value",e),t.querySelector("input[type=checkbox]").checked=!0,ann.createListener(n,"keydown",(function(e,t){13===t.keyCode&&n.blur()}))}},ann.Subroutine("authpatron+ann.cl.onload.patronAuth",["div_y","auth_x","div_y","input_text_@blur","$2_div_y","input_checkbox_@click","$2_span","$2_span"],[null,null,null,"label_Patron Key",null,"label_KEEP","&#10227;","&#x2717;"],["dyn-w","dyn-w slideUp",null,null,"w-25px p-5 o-v",null,"reload","authclose"],[null,null,null,t,null,e,n,a],[null,null,null,l,null,null,null,null])}));async function e(e,t){if(t.path[0].checked)ann.keep.isChecked=!0;else{if(localStorage.getItem("enwif")){if(ann.modal("CONFIRMATION","Your encrypted datakey is securely kept in browser's cache. Do you want to remove it?",2),await ann.modalResponse(),0==ann.get.modal.response){return void(document.querySelector("auth").querySelector("input[type=checkbox]").checked=!0)}localStorage.removeItem("enwif")}ann.keep.isChecked=!1}}async function t(e,t,n){var a=t.path[0].getAttribute("value")&&52===t.path[0].getAttribute("value").length?t.path[0].getAttribute("value"):t.path[0].value;if(a&&52===a.length){let e=ann.getPublicAddressFromWif(a);if(e){let l={pub:e};ann.fetch("getIK",l,"POST").then((async function(e){if(e.ik.includes("not found"))ann.modal("NOT FOUND","<span class='inlineb'>Our server could not find your identity Please enter correct Patron Key.</span>",1);else if(e.count&&e.ik){var l=await ann.decryptRoutine(a,!0,e.ik,e.count);if(l.pub&&l.item&&52===l.item.length&&l.msg){let r=localStorage.getItem("auth");if(ann.keep.isChecked&&"true"!==r){if(ann.modal("SESSION PASSWORD","Enter session password",2,null,1),await ann.modalResponse(),0==ann.get.modal.response)return;var o=localStorage.getItem("pass");let e=await ann.encryptRoutine(a,o);localStorage.removeItem("pass"),localStorage.setItem("enwif",e.item)}else ann.keep.isChecked||localStorage.removeItem("enwif");t.path[0].value=sha256(t.path[0].value),t.path[0].setAttribute("value",sha256(t.path[0].value));let i=document.querySelector("autharea");i&&i.parentElement&&i.parentElement.remove(),n(l,e.ik,a,e.count),localStorage.removeItem("auth")}}}))}else ann.modal("INVALID KEY","<span class='inlineb'>Please enter correct Patron Key</span>",1)}}async function n(e,t){localStorage.removeItem("auth"),await ann.cl.auth.handleAuth()}async function a(e,t){let n=document.querySelector("autharea");n&&n.parentElement&&(ann.toggleSlide(n.parentElement),setTimeout((function(){n.parentElement.remove()}),2500))}},ann.cl.auth.handleAuth=async function(e=!1){ann.require("auth").then((async function(t){var n=t;setTimeout((async function(){ann.isVisible(n)||ann.toggleSlide(n)}),500);let a=n.querySelector("input"),l=localStorage.getItem("enwif")?localStorage.getItem("enwif"):void 0;if(l&&l.length>52){if(a.setAttribute("value",l),ann.modal("SESSION PASSWORD","Enter session password",2,null,1),await ann.modalResponse(),0==ann.get.modal.response)return void a.removeAttribute("value");let e=localStorage.getItem("pass");localStorage.removeItem("pass");let t=await ann.decryptRoutine(l,e);t&&t.item&&52===t.item.length?(localStorage.setItem("auth","true"),ann.keep.isChecked=!0,a.setAttribute("value",t.item),a.focus(),a.blur()):(a.removeAttribute("value"),ann.cl.auth.handleAuth())}else e||ann.modal("MISSING DATAKEY","No datakey has been found. Please enter your datakey.",1)}))};